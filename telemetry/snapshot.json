{
  "snapshot_version": "v1",
  "schema_hash": "e1c88934ea2a3f560c4ddca6a2bde8dacb5ac92a29f04f4e8fb47dcc12715b3a",
  "context_id": "ctx-1770670214331-1",
  "generated_at_ms": 1770670215946,
  "window_ms": 1613,
  "tool_calls": {
    "head": {
      "tool": "defi/wallet_sign_message",
      "calls": 2,
      "successes": 2,
      "failures": 0,
      "avg_duration_ms": 0.5,
      "error_classes": [],
      "success_rate": 1.0,
      "policy": {
        "allowed": true,
        "rule_id": "allow:defi/wallet_sign_message",
        "reason": "explicit message signing allowed"
      },
      "costs": {
        "estimated_usd": 0.0002,
        "tokens": 0
      }
    },
    "tail": [
      {
        "tool": "defi/wallet_derive_address",
        "calls": 2,
        "successes": 2,
        "failures": 0,
        "avg_duration_ms": 0.0,
        "error_classes": [],
        "success_rate": 1.0,
        "policy": {
          "allowed": true,
          "rule_id": "allow:defi/wallet_derive_address",
          "reason": "read-only address derivation"
        },
        "costs": {
          "estimated_usd": 0.0002,
          "tokens": 0
        }
      }
    ]
  },
  "totals": {
    "tool_calls": 4,
    "tool_successes": 4,
    "tool_failures": 0,
    "avg_duration_ms": 0.25
  },
  "policy": {
    "mode": "default-deny",
    "rules": [
      {
        "tool": "defi/wallet_derive_address",
        "allowed": true,
        "rule_id": "allow:defi/wallet_derive_address",
        "reason": "read-only address derivation"
      },
      {
        "tool": "defi/wallet_sign_message",
        "allowed": true,
        "rule_id": "allow:defi/wallet_sign_message",
        "reason": "explicit message signing allowed"
      },
      {
        "tool": "defi/wallet_sign_tx",
        "allowed": false,
        "rule_id": "deny:defi/wallet_sign_tx",
        "reason": "transaction signing disabled in demo"
      }
    ],
    "decisions": [
      {
        "allowed": true,
        "rule_id": "allow:defi/wallet_sign_message",
        "reason": "explicit message signing allowed"
      },
      {
        "allowed": true,
        "rule_id": "allow:defi/wallet_derive_address",
        "reason": "read-only address derivation"
      }
    ],
    "violations": []
  },
  "costs": {
    "total_estimated_usd": 0.0004,
    "total_tokens": 0
  }
}
